{"version":3,"file":"chart.js","sources":["chart.js","/source/chart.js"],"names":["global","factory","exports","module","require","define","amd","KotoIcicle","d3","Koto","KotoTooltip","this","hierarchy","keySetter","depth","d","map","mapType","array","maxLength","rollup","call","nest","sortValues","sort","keyValue","object","setter","size","values","i","n","length","key","valuesByKey","filter","get","push","set","Object","keys","forEach","entries","sortKey","sortKeys","keyMap","name","children","a","b","newMaxLength","f","order","configs","description","value","type","units","category","getter","newValue","Icicle","_Koto","selection","click","_Chart","x","domain","dx","y","range","config","_group","selectAll","transition","duration","attr","dy","_targetData","left","top","style","textLength","isRelated","thing","relative","isChild","isParent","_x","_x2","parent","getParent","_x3","_x4","rootName","item","accessor","percent","format","overUnder","scale","linear","color","ordinal","partition","layout","base","append","_tooltip","opacity","_tooltipValue","_appends","_tooltipRect","_tooltipLabel","trigger","icicle","layer","dataBind","data","root","target","insert","on","datum","text","_tooltipRect2","_tooltipLabel2","coordinates","mouse","node","select","_d","symbol","svg","gen","transform","totalDuration","max","ease","delay","shouldShow","canFit","getComputedTextLength","prototype","row","targetData","preDraw","level1","child","chart"],"mappings":"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","sourceRoot":"/source/","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('d3'), require('koto'), require('koto-tooltip')) :\n  typeof define === 'function' && define.amd ? define(['d3', 'koto', 'koto-tooltip'], factory) :\n  global.KotoIcicle = factory(global.d3, global.Koto, global.KotoTooltip)\n}(this, function (d3, Koto, KotoTooltip) { 'use strict';\n\n  /**\n   * This will convert a flat, 2D array into a nested data structure.\n   * Simular to d3.nest but allows n number of depths for each node\n   */\n\n  // jscs:disable\n  function hierarchy () {\n    var nest = {},\n        keys = [],\n        sortKeys = [],\n        maxLength = 0,\n        sortValues,\n        rollup,\n        filter = function (d) {\n          return d !== null;\n        };\n\n   function keySetter (depth) {\n      return function (d) {\n        return d[depth];\n      };\n    }\n\n    function map(mapType, array, depth) {\n      if (depth >= maxLength) {\n        return rollup\n          ? rollup.call(nest, array) : (sortValues\n          ? array.sort(sortValues)\n          : array);\n      }\n\n      var i = -1,\n          n = array.length,\n          key = keySetter(depth++),\n          keyValue,\n          object,\n          setter,\n          size,\n          valuesByKey = d3.map({}),\n          values;\n\n      /*jshint -W084 */\n      while (++i < n) {\n        if (depth === 1) {\n          object = array[i].filter(filter);\n        } else {\n          object = array[i];\n        }\n        values = valuesByKey.get(keyValue = key(object));\n        if (array[i].length > depth) {\n          if (values) {\n            values.push(object);\n          } else {\n            valuesByKey.set(keyValue, [object]);\n          }\n        }\n      }\n\n      if (mapType) {\n        object = mapType();\n        size = function (object) {\n          return object.size();\n        };\n        setter = function(keyValue, values) {\n          object.set(keyValue, map(mapType, values, depth));\n        };\n      } else {\n        object = {};\n        size = function (object) {\n          return Object.keys(object).length;\n        };\n        setter = function(keyValue, values) {\n          object[keyValue] = map(mapType, values, depth);\n        };\n      }\n\n      valuesByKey.forEach(setter);\n      if (!size(object)) {\n        return array;\n      }\n      return object;\n    }\n\n    function entries(map, depth) {\n      if (depth >= maxLength || depth > map.length - 1) {\n        return map;\n      }\n\n      var array = [],\n          sortKey = sortKeys[depth++];\n\n      map.forEach(function(key, keyMap) {\n        array.push({name: key, children: entries(keyMap, depth)});\n      });\n\n      return sortKey\n        ? array.sort(function(a, b) { return sortKey(a.name, b.name); })\n        : array;\n    }\n\n    nest.map = function(array, mapType) {\n      return map(mapType, array, 0);\n    };\n\n    nest.entries = function(array) {\n      return entries(map(d3.map, array, 0), 0);\n    };\n\n    nest.maxLength = function(newMaxLength) {\n      maxLength = newMaxLength - 2;\n      return nest;\n    };\n\n    nest.filter = function (f) {\n      filter = f;\n      return nest;\n    };\n\n    // Specifies the order for the most-recently specified key.\n    // Note: only applies to entries. Map keys are unordered!\n    nest.sortKeys = function(order, depth) {\n      depth = depth || maxLength;\n      sortKeys[depth] = order;\n      return nest;\n    };\n\n    // Specifies the order for leaf values.\n    // Applies to both maps and entries array.\n    nest.sortValues = function(order) {\n      sortValues = order;\n      return nest;\n    };\n\n    nest.rollup = function(f) {\n      rollup = f;\n      return nest;\n    };\n\n    return nest;\n  }\n  // jscs:enable\n\n  var configs = [{\n    name: 'height',\n    description: 'The height of the chart.',\n    value: 700,\n    type: 'number',\n    units: 'px',\n    category: 'Size',\n    getter: function (){\n      // get value\n      // console.log('getter');\n      return this.value;\n    },\n    setter: function (newValue){\n      // Set something\n      // console.log('setter');\n      return newValue;\n    }\n  }, {\n    name: 'width',\n    description: 'The widthj of the chart.',\n    value: 900,\n    units: 'px',\n    type: 'number',\n    category: 'Size'\n  }, {\n    name: 'transitionDuration',\n    description: 'How long should it take to animate on click.',\n    value: 750,\n    units: 'ms',\n    type: 'number',\n    category: 'Animation'\n  }, {\n    name: 'introDuration',\n    description: 'How long should it take to animate in.',\n    value: 2000,\n    units: 'ms',\n    type: 'number',\n    category: 'Animation'\n  }, {\n    name: 'colorRange',\n    value: ['#BBE491', '#FB8D34', '#E45621', '#73B0D7'],\n    description: 'colors for categories',\n    type: 'colorArray',\n    category: 'Color'\n  }];\n\n  class Icicle extends Koto {\n  \tconstructor(selection) {\n      super(selection);\n      var _Chart = this;\n\n      // load configs\n      configs.forEach(function (item) {\n        _Chart.configs.set(item.name, item);\n      });\n\n      // accessors\n      this.accessor('name', function (d) { return d[d.length-2]; });\n\n      // formatters\n      var percent = d3.format('%');\n      var overUnder = d3.format('+%');\n\n      // scales\n      this.x = d3.scale.linear();\n      this.y = d3.scale.linear();\n      this.color = d3.scale.ordinal();\n\n      // layouts\n      this.partition = d3.layout.partition()\n        .value(function(d) { return d[d.length - 1]; });\n\n      // setup main group\n      this._group = this.base.append('g');\n      \n      // Set up tool tip;\n      this._tooltip = new KotoTooltip(this.base.append('g'));\n\n      this._tooltip.config({\n        opacity: 1,\n        format: 'textRectText'\n      });\n\n      this._tooltipValue = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      this._tooltipRect = this._tooltip._appends.append('rect');\n      this._tooltipLabel = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      \n      this._tooltip.trigger('draw');\n      this._tooltip.trigger('remove');\n      \n      // Setup Layers\n      var icicle = this.layer('icicle', this._group, {\n        dataBind: function (data) {\n          var root = _Chart.partition(data[0]);\n          if (_Chart._targetData) {\n            var target = _Chart.partition(_Chart._targetData[0]);\n            for (var i=0; i < root.length; i++) {\n              root[i].target = target[i].value;\n            }\n          }\n          return this.selectAll('g').data(root);\n        },\n        insert: function () {\n          return this.append('g')\n            .on('click', click)\n            .on('mouseover', function (d) {\n              _Chart._group.selectAll('rect')\n                .filter(function (datum) {\n                  var thingName = d.name ? d.name : d[d.length - 2];\n                  return !isRelated(d, datum);\n                })\n                .style('fill', '#e3e3e3');\n\n                _Chart._tooltipValue\n                  .text(d.name ? d.name : _Chart.accessor('name')(d));\n\n                _Chart._tooltipRect.style('fill', '#000');\n\n                _Chart._tooltipLabel\n                  .text(percent(d.value));\n\n                if (_Chart._targetData) {\n                  _Chart._tooltipRect2.style('fill', '#000');\n                  _Chart._tooltipLabel2\n                    .text(overUnder(d.value - d.target));\n                }\n\n                _Chart._tooltip.trigger('draw');\n              })\n              .on('mousemove', function () {\n                var coordinates = d3.mouse(_Chart.base.node());\n                _Chart._tooltip.trigger('moveTo', {x: coordinates[0], y: coordinates[1]}, null, _Chart.config('width'), _Chart.config('height'));\n              })\n              .on('mouseout', function (d) {\n                _Chart._group.selectAll('rect')\n                  .style('fill', function(d) { return _Chart.color(d.base); });\n\n                _Chart._tooltip.trigger('remove');\n              });\n        }\n      });\n    \n      // layer life-cycle events\n      icicle.on('enter', function () {\n        this.append('rect')\n          .style('stroke', '#fff');\n        \n        if (_Chart._targetData) {\n          this.append('path');\n        }\n\n        this.append('text')\n          .style('pointer-events', 'none');\n\n        return this;\n      })\n      .on('merge', function () {\n        // boxes\n        this.select('rect')\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.dx); })\n          .attr('height', 0)\n          .style('fill', function(d) { d.base = getParent(d, _Chart.rootName); return _Chart.color(d.base); });\n\n        // over-under indicator\n        if (_Chart._targetData) {\n          this.select('path')\n            .style('fill', '#555')\n            .style('opacity', 0)\n            .attr({\n              d: function (d) {\n                var symbol = d3.svg.symbol();\n                var gen = d.value > d.target ? symbol.type('triangle-up') : d.value < d.target ? symbol.type('triangle-down') : symbol.type('triangle-down');\n                return gen();\n              },\n              transform: function (d) {\n                var left = _Chart.x(d.x) + 15;\n                var top = _Chart.y(d.y) + 15;\n                \n                return `translate(${left},${top})`;\n              }\n            });\n        }\n\n        // labels\n        this.select('text')\n          .text(function (d) { return d.name ? d.name : d[d.length - 2]; })\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('dx', _Chart._targetData ? 25 : 5)\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('dy', 16)\n          .style('alignment-baseline', 'middle')\n          .style('fill', '#555')\n          .style('font-family', 'Open Sans')\n          .style('opacity', 0);\n      })\n      .on('merge:transition', function () {\n        var totalDuration = _Chart.config('introDuration');\n        var duration = totalDuration/(_Chart.max-1);\n        \n        // rects\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .select('rect')\n          .attr('height', function(d) { return _Chart.y(d.dy); });\n        \n        // paths\n        if (_Chart._targetData) {\n          this\n            .delay(totalDuration)\n            .selectAll('path')\n            .style('opacity', function (d) {\n              var shouldShow = d.value > d.target || d.value < d.target;\n              var canFit = _Chart.x(d.dx) > 25;\n              return shouldShow && canFit ? 1 : 0;\n            });\n        }\n\n        // linear\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .select('text')\n          .style('opacity', function (d) {\n            d.textLength = this.getComputedTextLength();\n            return (d.textLength + 30) < _Chart.x(d.dx) ? 1 : 0;\n          });\n        return this;\n      });\n\n      // click event handler\n      function click(d) {\n        _Chart.x.domain([d.x, d.x + d.dx]);\n        _Chart.y.domain([d.y, 1]).range([d.y ? 20 : 0, _Chart.config('height')]);\n\n        // transition Rects\n        _Chart._group.selectAll('rect')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.x + d.dx) - _Chart.x(d.x); })\n          .attr('height', function(d) { return _Chart.y(d.y + d.dy) - _Chart.y(d.y); });\n\n        // transition paths\n        if (_Chart._targetData) {\n          _Chart._group.selectAll('path')\n            .transition()\n            .duration(_Chart.config('transitionDuration'))\n            .attr('transform', function (d) {\n              var left = _Chart.x(d.x) + 15;\n              var top = _Chart.y(d.y) + 15;\n              return `translate(${left},${top})`;\n            });\n        }\n\n        // transition text\n        _Chart._group.selectAll('text')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .style('opacity', function (d) {\n            return (d.textLength + 12) < (_Chart.x(d.x + d.dx) - _Chart.x(d.x)) ? 1 : 0;\n          });\n      }\n\n      // check to see if nodes are related\n      function isRelated(thing, relative) {\n        return (isChild(thing, relative) || isParent(thing, relative));\n      }\n\n      // check to see if node is child\n      function isChild(thing, relative) {\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.parent) {\n          return false;\n        }\n        return isChild(thing.parent, relative);\n      }\n\n      // check to see if node is parent\n      function isParent (thing, relative) {\n        var i;\n        var temp;\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.children) {\n          return false;\n        }\n        for (i=0; i < thing.children.length; i++) {\n          if (isParent(thing.children[i], relative)) {\n            return true;\n          }\n        }\n        return false;\n      }\n\n      // get parents name - for color\n      function getParent (d, rootName) {\n        if (!d.parent) {\n          return d.name;\n        }\n        if (d.parent.name === rootName) {\n          return d.name;\n        }\n        return getParent(d.parent, rootName);\n      }\n    }\n\n    transform(data){\n      this.max = d3.max(data, function (row) { return row.length; });\n      return hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n    }\n\n    targetData(data){\n      this._targetData = hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n\n      this._tooltipRect2 = this._tooltip._appends.append('rect');\n      this._tooltipLabel2 = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      return this;\n    }\n\n    preDraw(data){\n      this.x.range([0, this.config('width')]);\n      this.y.range([0, this.config('height')]);\n      this.rootName = data[0].name;\n      \n      var level1 = data[0].children.map(function (child) { return child.name; });\n      level1.push(this.rootName);\n      this.color.range(this.config('colorRange')).domain(level1);\n    }\n  }\n\n  var chart = Icicle;\n\n  return chart;\n\n}));\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('d3'), require('koto'), require('koto-tooltip')) :\n  typeof define === 'function' && define.amd ? define(['d3', 'koto', 'koto-tooltip'], factory) :\n  global.KotoIcicle = factory(global.d3, global.Koto, global.KotoTooltip)\n}(this, function (d3, Koto, KotoTooltip) { 'use strict';\n\n  /**\n   * This will convert a flat, 2D array into a nested data structure.\n   * Simular to d3.nest but allows n number of depths for each node\n   */\n\n  // jscs:disable\n  function hierarchy () {\n    var nest = {},\n        keys = [],\n        sortKeys = [],\n        maxLength = 0,\n        sortValues,\n        rollup,\n        filter = function (d) {\n          return d !== null;\n        };\n\n   function keySetter (depth) {\n      return function (d) {\n        return d[depth];\n      };\n    }\n\n    function map(mapType, array, depth) {\n      if (depth >= maxLength) {\n        return rollup\n          ? rollup.call(nest, array) : (sortValues\n          ? array.sort(sortValues)\n          : array);\n      }\n\n      var i = -1,\n          n = array.length,\n          key = keySetter(depth++),\n          keyValue,\n          object,\n          setter,\n          size,\n          valuesByKey = d3.map({}),\n          values;\n\n      /*jshint -W084 */\n      while (++i < n) {\n        if (depth === 1) {\n          object = array[i].filter(filter);\n        } else {\n          object = array[i];\n        }\n        values = valuesByKey.get(keyValue = key(object));\n        if (array[i].length > depth) {\n          if (values) {\n            values.push(object);\n          } else {\n            valuesByKey.set(keyValue, [object]);\n          }\n        }\n      }\n\n      if (mapType) {\n        object = mapType();\n        size = function (object) {\n          return object.size();\n        };\n        setter = function(keyValue, values) {\n          object.set(keyValue, map(mapType, values, depth));\n        };\n      } else {\n        object = {};\n        size = function (object) {\n          return Object.keys(object).length;\n        };\n        setter = function(keyValue, values) {\n          object[keyValue] = map(mapType, values, depth);\n        };\n      }\n\n      valuesByKey.forEach(setter);\n      if (!size(object)) {\n        return array;\n      }\n      return object;\n    }\n\n    function entries(map, depth) {\n      if (depth >= maxLength || depth > map.length - 1) {\n        return map;\n      }\n\n      var array = [],\n          sortKey = sortKeys[depth++];\n\n      map.forEach(function(key, keyMap) {\n        array.push({name: key, children: entries(keyMap, depth)});\n      });\n\n      return sortKey\n        ? array.sort(function(a, b) { return sortKey(a.name, b.name); })\n        : array;\n    }\n\n    nest.map = function(array, mapType) {\n      return map(mapType, array, 0);\n    };\n\n    nest.entries = function(array) {\n      return entries(map(d3.map, array, 0), 0);\n    };\n\n    nest.maxLength = function(newMaxLength) {\n      maxLength = newMaxLength - 2;\n      return nest;\n    };\n\n    nest.filter = function (f) {\n      filter = f;\n      return nest;\n    };\n\n    // Specifies the order for the most-recently specified key.\n    // Note: only applies to entries. Map keys are unordered!\n    nest.sortKeys = function(order, depth) {\n      depth = depth || maxLength;\n      sortKeys[depth] = order;\n      return nest;\n    };\n\n    // Specifies the order for leaf values.\n    // Applies to both maps and entries array.\n    nest.sortValues = function(order) {\n      sortValues = order;\n      return nest;\n    };\n\n    nest.rollup = function(f) {\n      rollup = f;\n      return nest;\n    };\n\n    return nest;\n  }\n  // jscs:enable\n\n  var configs = [{\n    name: 'height',\n    description: 'The height of the chart.',\n    value: 700,\n    type: 'number',\n    units: 'px',\n    category: 'Size',\n    getter: function (){\n      // get value\n      // console.log('getter');\n      return this.value;\n    },\n    setter: function (newValue){\n      // Set something\n      // console.log('setter');\n      return newValue;\n    }\n  }, {\n    name: 'width',\n    description: 'The widthj of the chart.',\n    value: 900,\n    units: 'px',\n    type: 'number',\n    category: 'Size'\n  }, {\n    name: 'transitionDuration',\n    description: 'How long should it take to animate on click.',\n    value: 750,\n    units: 'ms',\n    type: 'number',\n    category: 'Animation'\n  }, {\n    name: 'introDuration',\n    description: 'How long should it take to animate in.',\n    value: 2000,\n    units: 'ms',\n    type: 'number',\n    category: 'Animation'\n  }, {\n    name: 'colorRange',\n    value: ['#BBE491', '#FB8D34', '#E45621', '#73B0D7'],\n    description: 'colors for categories',\n    type: 'colorArray',\n    category: 'Color'\n  }];\n\n  class Icicle extends Koto {\n  \tconstructor(selection) {\n      super(selection);\n      var _Chart = this;\n\n      // load configs\n      configs.forEach(function (item) {\n        _Chart.configs.set(item.name, item);\n      });\n\n      // accessors\n      this.accessor('name', function (d) { return d[d.length-2]; });\n\n      // formatters\n      var percent = d3.format('%');\n      var overUnder = d3.format('+%');\n\n      // scales\n      this.x = d3.scale.linear();\n      this.y = d3.scale.linear();\n      this.color = d3.scale.ordinal();\n\n      // layouts\n      this.partition = d3.layout.partition()\n        .value(function(d) { return d[d.length - 1]; });\n\n      // setup main group\n      this._group = this.base.append('g');\n      \n      // Set up tool tip;\n      this._tooltip = new KotoTooltip(this.base.append('g'));\n\n      this._tooltip.config({\n        opacity: 1,\n        format: 'textRectText'\n      });\n\n      this._tooltipValue = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      this._tooltipRect = this._tooltip._appends.append('rect');\n      this._tooltipLabel = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      \n      this._tooltip.trigger('draw');\n      this._tooltip.trigger('remove');\n      \n      // Setup Layers\n      var icicle = this.layer('icicle', this._group, {\n        dataBind: function (data) {\n          var root = _Chart.partition(data[0]);\n          if (_Chart._targetData) {\n            var target = _Chart.partition(_Chart._targetData[0]);\n            for (var i=0; i < root.length; i++) {\n              root[i].target = target[i].value;\n            }\n          }\n          return this.selectAll('g').data(root);\n        },\n        insert: function () {\n          return this.append('g')\n            .on('click', click)\n            .on('mouseover', function (d) {\n              _Chart._group.selectAll('rect')\n                .filter(function (datum) {\n                  var thingName = d.name ? d.name : d[d.length - 2];\n                  return !isRelated(d, datum);\n                })\n                .style('fill', '#e3e3e3');\n\n                _Chart._tooltipValue\n                  .text(d.name ? d.name : _Chart.accessor('name')(d));\n\n                _Chart._tooltipRect.style('fill', '#000');\n\n                _Chart._tooltipLabel\n                  .text(percent(d.value));\n\n                if (_Chart._targetData) {\n                  _Chart._tooltipRect2.style('fill', '#000');\n                  _Chart._tooltipLabel2\n                    .text(overUnder(d.value - d.target));\n                }\n\n                _Chart._tooltip.trigger('draw');\n              })\n              .on('mousemove', function () {\n                var coordinates = d3.mouse(_Chart.base.node());\n                _Chart._tooltip.trigger('moveTo', {x: coordinates[0], y: coordinates[1]}, null, _Chart.config('width'), _Chart.config('height'));\n              })\n              .on('mouseout', function (d) {\n                _Chart._group.selectAll('rect')\n                  .style('fill', function(d) { return _Chart.color(d.base); });\n\n                _Chart._tooltip.trigger('remove');\n              });\n        }\n      });\n    \n      // layer life-cycle events\n      icicle.on('enter', function () {\n        this.append('rect')\n          .style('stroke', '#fff');\n        \n        if (_Chart._targetData) {\n          this.append('path');\n        }\n\n        this.append('text')\n          .style('pointer-events', 'none');\n\n        return this;\n      })\n      .on('merge', function () {\n        // boxes\n        this.select('rect')\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.dx); })\n          .attr('height', 0)\n          .style('fill', function(d) { d.base = getParent(d, _Chart.rootName); return _Chart.color(d.base); });\n\n        // over-under indicator\n        if (_Chart._targetData) {\n          this.select('path')\n            .style('fill', '#555')\n            .style('opacity', 0)\n            .attr({\n              d: function (d) {\n                var symbol = d3.svg.symbol();\n                var gen = d.value > d.target ? symbol.type('triangle-up') : d.value < d.target ? symbol.type('triangle-down') : symbol.type('triangle-down');\n                return gen();\n              },\n              transform: function (d) {\n                var left = _Chart.x(d.x) + 15;\n                var top = _Chart.y(d.y) + 15;\n                \n                return `translate(${left},${top})`;\n              }\n            });\n        }\n\n        // labels\n        this.select('text')\n          .text(function (d) { return d.name ? d.name : d[d.length - 2]; })\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('dx', _Chart._targetData ? 25 : 5)\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('dy', 16)\n          .style('alignment-baseline', 'middle')\n          .style('fill', '#555')\n          .style('font-family', 'Open Sans')\n          .style('opacity', 0);\n      })\n      .on('merge:transition', function () {\n        var totalDuration = _Chart.config('introDuration');\n        var duration = totalDuration/(_Chart.max-1);\n        \n        // rects\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .select('rect')\n          .attr('height', function(d) { return _Chart.y(d.dy); });\n        \n        // paths\n        if (_Chart._targetData) {\n          this\n            .delay(totalDuration)\n            .selectAll('path')\n            .style('opacity', function (d) {\n              var shouldShow = d.value > d.target || d.value < d.target;\n              var canFit = _Chart.x(d.dx) > 25;\n              return shouldShow && canFit ? 1 : 0;\n            });\n        }\n\n        // linear\n        this\n          .duration(duration)\n          .ease('linear')\n          .delay(function (d) { return d.depth * duration; })\n          .select('text')\n          .style('opacity', function (d) {\n            d.textLength = this.getComputedTextLength();\n            return (d.textLength + 30) < _Chart.x(d.dx) ? 1 : 0;\n          });\n        return this;\n      });\n\n      // click event handler\n      function click(d) {\n        _Chart.x.domain([d.x, d.x + d.dx]);\n        _Chart.y.domain([d.y, 1]).range([d.y ? 20 : 0, _Chart.config('height')]);\n\n        // transition Rects\n        _Chart._group.selectAll('rect')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .attr('width', function(d) { return _Chart.x(d.x + d.dx) - _Chart.x(d.x); })\n          .attr('height', function(d) { return _Chart.y(d.y + d.dy) - _Chart.y(d.y); });\n\n        // transition paths\n        if (_Chart._targetData) {\n          _Chart._group.selectAll('path')\n            .transition()\n            .duration(_Chart.config('transitionDuration'))\n            .attr('transform', function (d) {\n              var left = _Chart.x(d.x) + 15;\n              var top = _Chart.y(d.y) + 15;\n              return `translate(${left},${top})`;\n            });\n        }\n\n        // transition text\n        _Chart._group.selectAll('text')\n          .transition()\n          .duration(_Chart.config('transitionDuration'))\n          .attr('x', function(d) { return _Chart.x(d.x); })\n          .attr('y', function(d) { return _Chart.y(d.y); })\n          .style('opacity', function (d) {\n            return (d.textLength + 12) < (_Chart.x(d.x + d.dx) - _Chart.x(d.x)) ? 1 : 0;\n          });\n      }\n\n      // check to see if nodes are related\n      function isRelated(thing, relative) {\n        return (isChild(thing, relative) || isParent(thing, relative));\n      }\n\n      // check to see if node is child\n      function isChild(thing, relative) {\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.parent) {\n          return false;\n        }\n        return isChild(thing.parent, relative);\n      }\n\n      // check to see if node is parent\n      function isParent (thing, relative) {\n        var i;\n        var temp;\n        if (thing === relative) {\n          return true;\n        }\n        if (!thing.children) {\n          return false;\n        }\n        for (i=0; i < thing.children.length; i++) {\n          if (isParent(thing.children[i], relative)) {\n            return true;\n          }\n        }\n        return false;\n      }\n\n      // get parents name - for color\n      function getParent (d, rootName) {\n        if (!d.parent) {\n          return d.name;\n        }\n        if (d.parent.name === rootName) {\n          return d.name;\n        }\n        return getParent(d.parent, rootName);\n      }\n    }\n\n    transform(data){\n      this.max = d3.max(data, function (row) { return row.length; });\n      return hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n    }\n\n    targetData(data){\n      this._targetData = hierarchy()\n        .maxLength(this.max)\n        .entries(data);\n\n      this._tooltipRect2 = this._tooltip._appends.append('rect');\n      this._tooltipLabel2 = this._tooltip._appends.append('text')\n        .style('font-family', 'Open Sans');\n      return this;\n    }\n\n    preDraw(data){\n      this.x.range([0, this.config('width')]);\n      this.y.range([0, this.config('height')]);\n      this.rootName = data[0].name;\n      \n      var level1 = data[0].children.map(function (child) { return child.name; });\n      level1.push(this.rootName);\n      this.color.range(this.config('colorRange')).domain(level1);\n    }\n  }\n\n  var chart = Icicle;\n\n  return chart;\n\n}));\n"]}